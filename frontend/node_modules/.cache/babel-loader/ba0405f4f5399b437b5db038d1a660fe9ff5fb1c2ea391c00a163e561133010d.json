{"ast":null,"code":"import React,{useState,useRef}from'react';import{uploadAPI}from'../../services/uploadAPI';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ImageUpload=_ref=>{let{onUploadSuccess,onUploadError,multiple=false,className=''}=_ref;const[uploading,setUploading]=useState(false);const[dragOver,setDragOver]=useState(false);const fileInputRef=useRef(null);const handleFileSelect=files=>{if(!files||files.length===0)return;const fileArray=Array.from(files);// Validate files\nconst invalidFiles=fileArray.filter(file=>{const validation=uploadAPI.validateFile(file);return!validation.isValid;});if(invalidFiles.length>0){const validation=uploadAPI.validateFile(invalidFiles[0]);toast.error(validation.error||'File không hợp lệ');if(onUploadError){onUploadError(validation.error||'File không hợp lệ');}return;}// Upload files\nhandleUpload(fileArray);};const handleUpload=async files=>{setUploading(true);try{let result;if(multiple&&files.length>1){var _result$uploaded;result=await uploadAPI.uploadMultipleImages(files);toast.success(`Đã tải lên ${((_result$uploaded=result.uploaded)===null||_result$uploaded===void 0?void 0:_result$uploaded.length)||0} ảnh thành công`);}else{result=await uploadAPI.uploadImage(files[0]);toast.success('Tải ảnh lên thành công!');}if(onUploadSuccess){onUploadSuccess(result);}}catch(error){const errorMessage=error.message||'Lỗi khi tải ảnh lên';toast.error(errorMessage);if(onUploadError){onUploadError(errorMessage);}}finally{setUploading(false);if(fileInputRef.current){fileInputRef.current.value='';}}};const handleDragOver=e=>{e.preventDefault();setDragOver(true);};const handleDragLeave=e=>{e.preventDefault();setDragOver(false);};const handleDrop=e=>{e.preventDefault();setDragOver(false);handleFileSelect(e.dataTransfer.files);};const handleClick=()=>{var _fileInputRef$current;(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();};const handleFileInputChange=e=>{handleFileSelect(e.target.files);};return/*#__PURE__*/_jsxs(\"div\",{className:`relative ${className}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:`\n          border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all duration-200\n          ${dragOver?'border-primary-500 bg-primary-50':'border-gray-300 hover:border-primary-400'}\n          ${uploading?'pointer-events-none opacity-60':''}\n        `,onDragOver:handleDragOver,onDragLeave:handleDragLeave,onDrop:handleDrop,onClick:handleClick,children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",multiple:multiple,onChange:handleFileInputChange,className:\"hidden\"}),uploading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner h-8 w-8 mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\u0110ang t\\u1EA3i \\u1EA3nh l\\xEAn...\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"h-12 w-12 text-gray-400 mb-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-gray-700 mb-2\",children:multiple?'Tải lên nhiều ảnh':'Tải lên ảnh'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-4\",children:\"K\\xE9o th\\u1EA3 \\u1EA3nh v\\xE0o \\u0111\\xE2y ho\\u1EB7c click \\u0111\\u1EC3 ch\\u1ECDn file\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-400 space-y-1\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0110\\u1ECBnh d\\u1EA1ng: JPG, PNG, GIF, WebP, BMP\"}),/*#__PURE__*/_jsx(\"p\",{children:\"K\\xEDch th\\u01B0\\u1EDBc t\\u1ED1i \\u0111a: 5MB\"}),multiple&&/*#__PURE__*/_jsx(\"p\",{children:\"C\\xF3 th\\u1EC3 ch\\u1ECDn nhi\\u1EC1u file c\\xF9ng l\\xFAc\"})]})]})]}),dragOver&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-primary-500 bg-opacity-10 border-2 border-primary-500 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-primary-700 font-semibold text-lg\",children:\"Th\\u1EA3 \\u1EA3nh v\\xE0o \\u0111\\xE2y\"})})]});};export default ImageUpload;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}