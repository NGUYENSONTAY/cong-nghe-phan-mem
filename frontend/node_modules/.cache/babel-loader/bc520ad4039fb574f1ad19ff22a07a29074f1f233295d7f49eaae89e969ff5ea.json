{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{orderAPI}from'../api/orderAPI';import Loading from'../components/common/Loading';import{format}from'date-fns';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const statusDisplay={PENDING:{text:'Chờ xác nhận',className:'bg-yellow-100 text-yellow-800'},PROCESSING:{text:'Đang xử lý',className:'bg-blue-100 text-blue-800'},SHIPPED:{text:'Đang giao',className:'bg-purple-100 text-purple-800'},DELIVERED:{text:'Đã giao',className:'bg-green-100 text-green-800'},CANCELLED:{text:'Đã hủy',className:'bg-red-100 text-red-800'}};const OrdersPage=()=>{const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchOrders=async()=>{try{setLoading(true);const userOrders=await orderAPI.getUserOrders();setOrders(userOrders.sort((a,b)=>new Date(b.createdAt).getTime()-new Date(a.createdAt).getTime()));}catch(err){setError(err.message||'Không thể tải được lịch sử đơn hàng.');}finally{setLoading(false);}};fetchOrders();},[]);const formatPrice=price=>{return new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(price);};if(loading)return/*#__PURE__*/_jsx(Loading,{text:\"\\u0110ang t\\u1EA3i l\\u1ECBch s\\u1EED \\u0111\\u01A1n h\\xE0ng...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center p-12 text-red-500\",children:error});return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 min-h-screen py-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-8\",children:\"L\\u1ECBch s\\u1EED \\u0111\\u01A1n h\\xE0ng\"}),orders.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center bg-white p-12 rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold\",children:\"B\\u1EA1n ch\\u01B0a c\\xF3 \\u0111\\u01A1n h\\xE0ng n\\xE0o.\"}),/*#__PURE__*/_jsx(Link,{to:\"/books\",className:\"btn btn-primary mt-6\",children:\"B\\u1EAFt \\u0111\\u1EA7u mua s\\u1EAFm\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:orders.map(order=>{var _statusDisplay$order$,_statusDisplay$order$2;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 flex flex-col md:flex-row justify-between items-start md:items-center border-b bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold text-lg\",children:[\"\\u0110\\u01A1n h\\xE0ng #\",order._id.slice(-6)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Ng\\xE0y \\u0111\\u1EB7t: \",format(new Date(order.createdAt),'dd/MM/yyyy HH:mm')]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 md:mt-0 text-right\",children:[/*#__PURE__*/_jsx(\"span\",{className:`px-3 py-1 text-sm font-semibold rounded-full ${(_statusDisplay$order$=statusDisplay[order.status])===null||_statusDisplay$order$===void 0?void 0:_statusDisplay$order$.className}`,children:((_statusDisplay$order$2=statusDisplay[order.status])===null||_statusDisplay$order$2===void 0?void 0:_statusDisplay$order$2.text)||'Không rõ'}),/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-lg mt-2\",children:formatPrice(order.totalAmount)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-4 mb-4\",children:order.items.map(item=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.book.images[0],alt:item.book.title,className:\"w-16 h-20 object-cover rounded mr-4\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:item.book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"S\\u1ED1 l\\u01B0\\u1EE3ng: \",item.quantity]})]})]},item.book._id))}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsx(Link,{to:`/orders/${order._id}`,className:\"btn btn-outline btn-sm\",children:\"Xem chi ti\\u1EBFt\"})})]})]},order._id);})})]})});};export default OrdersPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}