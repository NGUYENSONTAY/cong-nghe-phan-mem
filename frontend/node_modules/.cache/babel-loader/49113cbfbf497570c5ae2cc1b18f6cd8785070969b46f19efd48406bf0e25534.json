{"ast":null,"code":"import React from'react';import{useParams,Link}from'react-router-dom';import{useQuery,useMutation,useQueryClient}from'react-query';import{orderAPI}from'../../api/orderAPI';import Loading from'../../components/common/Loading';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ORDER_STATUSES=['PENDING','PROCESSING','SHIPPED','DELIVERED','CANCELLED'];const getStatusClassName=status=>{switch(status){case'PENDING':return'bg-yellow-100 text-yellow-800';case'PROCESSING':return'bg-blue-100 text-blue-800';case'SHIPPED':return'bg-green-100 text-green-800';case'DELIVERED':return'bg-purple-100 text-purple-800';case'CANCELLED':return'bg-red-100 text-red-800';default:return'bg-gray-100 text-gray-800';}};const AdminOrderDetail=()=>{const{id}=useParams();const queryClient=useQueryClient();const{data:order,isLoading,error}=useQuery(['adminOrder',id],()=>orderAPI.getOrderById(id),{enabled:!!id});const updateStatusMutation=useMutation(_ref=>{let{status}=_ref;return orderAPI.updateOrderStatus(id,status);},{onSuccess:updatedOrder=>{queryClient.setQueryData(['adminOrder',id],updatedOrder);queryClient.invalidateQueries('adminOrders');toast.success('Cập nhật trạng thái đơn hàng thành công!');},onError:err=>{toast.error(`Lỗi: ${err.message}`);}});const handleStatusChange=e=>{const newStatus=e.target.value;updateStatusMutation.mutate({status:newStatus});};if(isLoading)return/*#__PURE__*/_jsx(Loading,{text:\"\\u0110ang t\\u1EA3i chi ti\\u1EBFt \\u0111\\u01A1n h\\xE0ng...\"});if(error||!order)return/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-center\",children:\"Kh\\xF4ng th\\u1EC3 t\\u1EA3i th\\xF4ng tin \\u0111\\u01A1n h\\xE0ng.\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(Link,{to:\"/admin/orders\",className:\"text-indigo-600 hover:text-indigo-900\",children:\"\\u2190 Quay l\\u1EA1i danh s\\xE1ch \\u0111\\u01A1n h\\xE0ng\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 mt-2\",children:\"Chi Ti\\u1EBFt \\u0110\\u01A1n H\\xE0ng\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-500 font-mono\",children:[\"ID: \",order._id]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-2 space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"C\\xE1c s\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsx(\"div\",{className:\"divide-y divide-gray-200\",children:order.items.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center py-4\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.book.images[0],alt:item.book.title,className:\"w-16 h-20 object-cover rounded-md mr-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:item.book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"S\\u1ED1 l\\u01B0\\u1EE3ng: \",item.quantity]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold\",children:[(item.price*item.quantity).toLocaleString('vi-VN'),\" \\u20AB\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"(\",item.price.toLocaleString('vi-VN'),\" \\u20AB/sp)\"]})]})]},item.book._id))}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t mt-4 pt-4 text-right\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-lg\",children:[\"T\\u1ED5ng c\\u1ED9ng: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-xl\",children:[order.totalAmount.toLocaleString('vi-VN'),\" \\u20AB\"]})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Tr\\u1EA1ng th\\xE1i \\u0111\\u01A1n h\\xE0ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:`px-3 py-1 text-sm font-semibold rounded-full ${getStatusClassName(order.status)} mr-4`,children:order.status}),/*#__PURE__*/_jsx(\"select\",{value:order.status,onChange:handleStatusChange,disabled:updateStatusMutation.isLoading,className:\"border-gray-300 rounded-lg shadow-sm\",children:ORDER_STATUSES.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))})]}),updateStatusMutation.isLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-blue-500 mt-2\",children:\"\\u0110ang c\\u1EADp nh\\u1EADt...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Th\\xF4ng tin kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-gray-700\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"T\\xEAn:\"}),\" \",order.customerName]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",order.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"S\\u0110T:\"}),\" \",order.phone]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0110\\u1ECBa ch\\u1EC9:\"}),\" \",order.address]}),order.note&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ghi ch\\xFA:\"}),\" \",order.note]})]})]})]})]})]});};export default AdminOrderDetail;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}