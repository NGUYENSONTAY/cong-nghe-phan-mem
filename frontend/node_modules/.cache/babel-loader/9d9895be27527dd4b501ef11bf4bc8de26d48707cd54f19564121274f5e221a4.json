{"ast":null,"code":"import React from'react';import{useParams,useNavigate,Link}from'react-router-dom';import{useQuery,useMutation,useQueryClient}from'react-query';import{toast}from'react-toastify';import{booksAPI}from'../../api/booksAPI';import BookForm from'../../components/admin/BookForm';import Loading from'../../components/common/Loading';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EditBook=()=>{const{id}=useParams();const navigate=useNavigate();const queryClient=useQueryClient();// Fetch the book data\nconst{data:book,isLoading:isLoadingBook,error}=useQuery(['book',id],()=>booksAPI.getBookById(id),{enabled:!!id// Only run the query if id is present\n});// Setup mutation for updating the book\nconst{mutateAsync,isLoading:isUpdating}=useMutation(data=>booksAPI.updateBook(id,data),{onSuccess:()=>{queryClient.invalidateQueries('adminBooks');queryClient.invalidateQueries(['book',id]);toast.success('Cập nhật sách thành công!');navigate('/admin/books');},onError:error=>{toast.error(`Lỗi khi cập nhật sách: ${error.message}`);}});const handleUpdateBook=async data=>{await mutateAsync(data);};if(isLoadingBook)return/*#__PURE__*/_jsx(Loading,{});if(error)return/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500\",children:[\"L\\u1ED7i khi t\\u1EA3i d\\u1EEF li\\u1EC7u s\\xE1ch: \",error.message]});if(!book)return/*#__PURE__*/_jsx(\"p\",{children:\"Kh\\xF4ng t\\xECm th\\u1EA5y s\\xE1ch.\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(Link,{to:\"/admin/books\",className:\"text-indigo-600 hover:text-indigo-900\",children:\"\\u2190 Quay l\\u1EA1i danh s\\xE1ch\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 mt-2\",children:\"Ch\\u1EC9nh S\\u1EEDa S\\xE1ch\"})]}),/*#__PURE__*/_jsx(BookForm,{onSubmit:handleUpdateBook,isSubmitting:isUpdating,initialData:book,submitButtonText:\"C\\u1EADp Nh\\u1EADt\"})]});};export default EditBook;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}